"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.solvePart2 = exports.solvePart1 = void 0;
const solvePart1 = async (input) => {
    const numbersDrawn = input
        .split('\n')[0]
        .split(',')
        .map((number) => parseInt(number));
    let boards = [];
    let boardIndex = 0;
    input
        .split('\n')
        .slice(2)
        .forEach((numbersRow) => {
        if (numbersRow === '') {
            boardIndex++;
        }
        else {
            const numbers = numbersRow
                .split(' ')
                .filter((value) => value !== '')
                .map((value) => ({ value: parseInt(value), isMarked: false }));
            const currentBoard = boards[boardIndex];
            let row = [numbers];
            if (currentBoard) {
                row = [...currentBoard, numbers];
            }
            boards[boardIndex] = row;
        }
    });
    let winningBoardSum = 0;
    let winningNumber = -1;
    let markedBoards = [];
    for (let i = 0; i < numbersDrawn.length; i++) {
        const drawnNumber = numbersDrawn[i];
        if (markedBoards.length === 0) {
            markedBoards = boards.map(markBoard.bind(null, drawnNumber));
        }
        else {
            markedBoards = markedBoards.map(markBoard.bind(null, drawnNumber));
        }
        winningBoardSum = getWinningBoardSum(markedBoards);
        if (winningBoardSum > 0) {
            winningNumber = drawnNumber;
            break;
        }
    }
    return { winningNumber, winningBoardSum, totalScore: winningBoardSum * winningNumber };
};
exports.solvePart1 = solvePart1;
function markBoard(value, board) {
    return board.map((row) => {
        return row.map((spot) => {
            if (!spot.isMarked) {
                return { ...spot, isMarked: spot.value === value };
            }
            return spot;
        });
    });
}
function getWinningBoardSum(markedBoards) {
    return (markedBoards
        .map((board) => {
        return board
            .map((row, rowIndex, allRows) => {
            return {
                board,
                rowLength: row.length,
                rowFiltered: row.filter(isSpotMarked),
                columnFiltered: getColumn(rowIndex, allRows).filter(isSpotMarked),
            };
        })
            .filter((rowAndColumn) => {
            const allSpotsMarkedRow = rowAndColumn.rowFiltered.length === rowAndColumn.rowLength;
            const allSpotsMarkedColumn = rowAndColumn.columnFiltered.length === rowAndColumn.rowLength;
            return allSpotsMarkedRow || allSpotsMarkedColumn;
        });
    })
        .filter((board) => board.length !== 0)
        .flat(2)
        .map(({ board }) => {
        return board
            .flat(2)
            .filter((spot) => !spot.isMarked)
            .map((spot) => spot.value)
            .reduce((sum, value) => sum + value, 0);
    })
        .reduce((_sum, value) => value, 0));
}
function getColumn(rowIndex, allRows) {
    let column = [];
    for (let i = 0; i < allRows.length; i++) {
        column.push(allRows[i][rowIndex]);
    }
    return column;
}
function isSpotMarked(spot) {
    return spot.isMarked;
}
const solvePart2 = async (input) => {
    return input.split('\n');
};
exports.solvePart2 = solvePart2;
exports.default = {
    solvePart1: exports.solvePart1,
    solvePart2: exports.solvePart2,
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRGF5MDQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJEYXkwNC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBTyxNQUFNLFVBQVUsR0FBRyxLQUFLLEVBQUUsS0FBYSxFQUFFLEVBQUU7SUFxQmhELE1BQU0sWUFBWSxHQUFHLEtBQUs7U0FDdkIsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUNkLEtBQUssQ0FBQyxHQUFHLENBQUM7U0FDVixHQUFHLENBQUMsQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFBO0lBRXBDLElBQUksTUFBTSxHQUFHLEVBQWdCLENBQUE7SUFDN0IsSUFBSSxVQUFVLEdBQUcsQ0FBQyxDQUFBO0lBQ2xCLEtBQUs7U0FDRixLQUFLLENBQUMsSUFBSSxDQUFDO1NBQ1gsS0FBSyxDQUFDLENBQUMsQ0FBQztTQUNSLE9BQU8sQ0FBQyxDQUFDLFVBQVUsRUFBRSxFQUFFO1FBQ3RCLElBQUksVUFBVSxLQUFLLEVBQUUsRUFBRTtZQUNyQixVQUFVLEVBQUUsQ0FBQTtTQUNiO2FBQU07WUFDTCxNQUFNLE9BQU8sR0FBRyxVQUFVO2lCQUN2QixLQUFLLENBQUMsR0FBRyxDQUFDO2lCQUNWLE1BQU0sQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsS0FBSyxLQUFLLEVBQUUsQ0FBQztpQkFDL0IsR0FBRyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLFFBQVEsQ0FBQyxLQUFLLENBQUMsRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFBO1lBR2hFLE1BQU0sWUFBWSxHQUFHLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQTtZQUN2QyxJQUFJLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFBO1lBQ25CLElBQUksWUFBWSxFQUFFO2dCQUNoQixHQUFHLEdBQUcsQ0FBQyxHQUFHLFlBQVks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VixrQkFBVTtDQUNYLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3Qgc29sdmVQYXJ0MSA9IGFzeW5jIChpbnB1dDogc3RyaW5nKSA9PiB7XG4gIC8vICAgaW5wdXQgPSBgNyw0LDksNSwxMSwxNywyMywyLDAsMTQsMjEsMjQsMTAsMTYsMTMsNiwxNSwyNSwxMiwyMiwxOCwyMCw4LDE5LDMsMjYsMVxuICAvL1xuICAvLyAyMiAxMyAxNyAxMSAgMFxuICAvLyAgOCAgMiAyMyAgNCAyNFxuICAvLyAyMSAgOSAxNCAxNiAgN1xuICAvLyAgNiAxMCAgMyAxOCAgNVxuICAvLyAgMSAxMiAyMCAxNSAxOVxuICAvL1xuICAvLyAgMyAxNSAgMCAgMiAyMlxuICAvLyAgOSAxOCAxMyAxNyAgNVxuICAvLyAxOSAgOCAgNyAyNSAyM1xuICAvLyAyMCAxMSAxMCAyNCAgNFxuICAvLyAxNCAyMSAxNiAxMiAgNlxuICAvL1xuICAvLyAxNCAyMSAxNyAyNCAgNFxuICAvLyAxMCAxNiAxNSAgOSAxOVxuICAvLyAxOCAgOCAyMyAyNiAyMFxuICAvLyAyMiAxMSAxMyAgNiAgNVxuICAvLyAgMiAgMCAxMiAgMyAgN2BcblxuICBjb25zdCBudW1iZXJzRHJhd24gPSBpbnB1dFxuICAgIC5zcGxpdCgnXFxuJylbMF1cbiAgICAuc3BsaXQoJywnKVxuICAgIC5tYXAoKG51bWJlcikgPT4gcGFyc2VJbnQobnVtYmVyKSlcblxuICBsZXQgYm9hcmRzID0gW10gYXMgQXJyYXk8YW55PlxuICBsZXQgYm9hcmRJbmRleCA9IDBcbiAgaW5wdXRcbiAgICAuc3BsaXQoJ1xcbicpXG4gICAgLnNsaWNlKDIpXG4gICAgLmZvckVhY2goKG51bWJlcnNSb3cpID0+IHtcbiAgICAgIGlmIChudW1iZXJzUm93ID09PSAnJykge1xuICAgICAgICBib2FyZEluZGV4KytcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IG51bWJlcnMgPSBudW1iZXJzUm93XG4gICAgICAgICAgLnNwbGl0KCcgJylcbiAgICAgICAgICAuZmlsdGVyKCh2YWx1ZSkgPT4gdmFsdWUgIT09ICcnKVxuICAgICAgICAgIC5tYXAoKHZhbHVlKSA9PiAoeyB2YWx1ZTogcGFyc2VJbnQodmFsdWUpLCBpc01hcmtlZDogZmFsc2UgfSkpXG5cbiAgICAgICAgLy8gQ2hlY2sgd2hldGhlciB0aGlzIGlzIHRoZSBmaXJzdCByb3dcbiAgICAgICAgY29uc3QgY3VycmVudEJvYXJkID0gYm9hcmRzW2JvYXJkSW5kZXhdXG4gICAgICAgIGxldCByb3cgPSBbbnVtYmVyc11cbiAgICAgICAgaWYgKGN1cnJlbnRCb2FyZCkge1xuICAgICAgICAgIHJvdyA9IFsuLi5jdXJyZW50Qm9hcmQsIG51bWJlcnNdXG4gICAgICAgIH1cbiAgICAgICAgYm9hcmRzW2JvYXJkSW5kZXhdID0gcm93XG4gICAgICB9XG4gICAgfSlcblxuICAvLyBUT0RPOiBGaW5kIHRoZSBib2FyZCB0aGF0IHdpbGwgd2luIEZJUlNUXG4gIGxldCB3aW5uaW5nQm9hcmRTdW0gPSAwXG4gIGxldCB3aW5uaW5nTnVtYmVyID0gLTFcbiAgbGV0IG1hcmtlZEJvYXJkcyA9IFtdXG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1iZXJzRHJhd24ubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBkcmF3bk51bWJlciA9IG51bWJlcnNEcmF3bltpXVxuXG4gICAgaWYgKG1hcmtlZEJvYXJkcy5sZW5ndGggPT09IDApIHtcbiAgICAgIG1hcmtlZEJvYXJkcyA9IGJvYXJkcy5tYXAobWFya0JvYXJkLmJpbmQobnVsbCwgZHJhd25OdW1iZXIpKVxuICAgIH0gZWxzZSB7XG4gICAgICBtYXJrZWRCb2FyZHMgPSBtYXJrZWRCb2FyZHMubWFwKG1hcmtCb2FyZC5iaW5kKG51bGwsIGRyYXduTnVtYmVyKSlcbiAgICB9XG5cbiAgICAvLyBOb3cgY2hlY2sgZm9yIGEgd2lubmVyXG4gICAgd2lubmluZ0JvYXJkU3VtID0gZ2V0V2lubmluZ0JvYXJkU3VtKG1hcmtlZEJvYXJkcylcblxuICAgIGlmICh3aW5uaW5nQm9hcmRTdW0gPiAwKSB7XG4gICAgICB3aW5uaW5nTnVtYmVyID0gZHJhd25OdW1iZXJcbiAgICAgIGJyZWFrXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHsgd2lubmluZ051bWJlciwgd2lubmluZ0JvYXJkU3VtLCB0b3RhbFNjb3JlOiB3aW5uaW5nQm9hcmRTdW0gKiB3aW5uaW5nTnVtYmVyIH1cbn1cblxuZnVuY3Rpb24gbWFya0JvYXJkKHZhbHVlLCBib2FyZCkge1xuICByZXR1cm4gYm9hcmQubWFwKChyb3cpID0+IHtcbiAgICByZXR1cm4gcm93Lm1hcCgoc3BvdCkgPT4ge1xuICAgICAgaWYgKCFzcG90LmlzTWFya2VkKSB7XG4gICAgICAgIHJldHVybiB7IC4uLnNwb3QsIGlzTWFya2VkOiBzcG90LnZhbHVlID09PSB2YWx1ZSB9XG4gICAgICB9XG4gICAgICByZXR1cm4gc3BvdFxuICAgIH0pXG4gIH0pXG59XG5cbmZ1bmN0aW9uIGdldFdpbm5pbmdCb2FyZFN1bShtYXJrZWRCb2FyZHMpIHtcbiAgcmV0dXJuIChcbiAgICBtYXJrZWRCb2FyZHNcbiAgICAgIC5tYXAoKGJvYXJkKSA9PiB7XG4gICAgICAgIHJldHVybiBib2FyZFxuICAgICAgICAgIC5tYXAoKHJvdywgcm93SW5kZXgsIGFsbFJvd3MpID0+IHtcbiAgICAgICAgICAgIC8vIENoZWNrIGJ5IHJvdywgYW5kIENPTFVNTiwgZm9yIGEgY2FzZSB3aGVyZSBhbGwgc3BvdHMgYXJlIG1hcmtlZFxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgYm9hcmQsXG4gICAgICAgICAgICAgIHJvd0xlbmd0aDogcm93Lmxlbmd0aCxcbiAgICAgICAgICAgICAgcm93RmlsdGVyZWQ6IHJvdy5maWx0ZXIoaXNTcG90TWFya2VkKSxcbiAgICAgICAgICAgICAgY29sdW1uRmlsdGVyZWQ6IGdldENvbHVtbihyb3dJbmRleCwgYWxsUm93cykuZmlsdGVyKGlzU3BvdE1hcmtlZCksXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZmlsdGVyKChyb3dBbmRDb2x1bW4pID0+IHtcbiAgICAgICAgICAgIC8vIFRPRE86IENoZWNrIChieSBDT0xVTU4gYW5kIFJPVykgZm9yIGEgY2FzZSB3aGVyZSBhbGwgdmFsdWVzIGFyZSBjaGVja2VkXG4gICAgICAgICAgICBjb25zdCBhbGxTcG90c01hcmtlZFJvdyA9IHJvd0FuZENvbHVtbi5yb3dGaWx0ZXJlZC5sZW5ndGggPT09IHJvd0FuZENvbHVtbi5yb3dMZW5ndGhcbiAgICAgICAgICAgIC8vIHJldHVybiBhbGxTcG90c01hcmtlZFJvd1xuXG4gICAgICAgICAgICBjb25zdCBhbGxTcG90c01hcmtlZENvbHVtbiA9XG4gICAgICAgICAgICAgIHJvd0FuZENvbHVtbi5jb2x1bW5GaWx0ZXJlZC5sZW5ndGggPT09IHJvd0FuZENvbHVtbi5yb3dMZW5ndGhcblxuICAgICAgICAgICAgcmV0dXJuIGFsbFNwb3RzTWFya2VkUm93IHx8IGFsbFNwb3RzTWFya2VkQ29sdW1uXG4gICAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgICAuZmlsdGVyKChib2FyZCkgPT4gYm9hcmQubGVuZ3RoICE9PSAwKVxuICAgICAgLmZsYXQoMilcbiAgICAgIC8vIC5tYXAoKHsgcm93RmlsdGVyZWQsIGNvbHVtbkZpbHRlcmVkLCBib2FyZCB9KSA9PiB7XG4gICAgICAubWFwKCh7IGJvYXJkIH0pID0+IHtcbiAgICAgICAgcmV0dXJuIGJvYXJkXG4gICAgICAgICAgLmZsYXQoMilcbiAgICAgICAgICAuZmlsdGVyKChzcG90KSA9PiAhc3BvdC5pc01hcmtlZClcbiAgICAgICAgICAubWFwKChzcG90KSA9PiBzcG90LnZhbHVlKVxuICAgICAgICAgIC5yZWR1Y2UoKHN1bSwgdmFsdWUpID0+IHN1bSArIHZhbHVlLCAwKVxuICAgICAgfSlcbiAgICAgIC5yZWR1Y2UoKF9zdW0sIHZhbHVlKSA9PiB2YWx1ZSwgMClcbiAgKVxufVxuXG5mdW5jdGlvbiBnZXRDb2x1bW4ocm93SW5kZXgsIGFsbFJvd3MpIHtcbiAgbGV0IGNvbHVtbiA9IFtdIGFzIEFycmF5PGFueT5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBhbGxSb3dzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29sdW1uLnB1c2goYWxsUm93c1tpXVtyb3dJbmRleF0pXG4gIH1cbiAgcmV0dXJuIGNvbHVtblxufVxuXG5mdW5jdGlvbiBpc1Nwb3RNYXJrZWQoc3BvdCkge1xuICByZXR1cm4gc3BvdC5pc01hcmtlZFxufVxuXG5leHBvcnQgY29uc3Qgc29sdmVQYXJ0MiA9IGFzeW5jIChpbnB1dDogc3RyaW5nKSA9PiB7XG4gIHJldHVybiBpbnB1dC5zcGxpdCgnXFxuJylcbn1cblxuZXhwb3J0IGRlZmF1bHQge1xuICBzb2x2ZVBhcnQxLFxuICBzb2x2ZVBhcnQyLFxufVxuIl19